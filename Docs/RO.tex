\documentclass[12pt]{article}[a4paper,14pt,russian]
\usepackage[russian]{babel}
\usepackage[utf8]{inputenc}
\usepackage{color}
\definecolor{lgreen}{rgb}{0.9,1,0.8}
\begin{document}
	\section{Общее описание системы}
	Система обработки данных представлена программным комплеком "Alarm" (Далее ПК "Alarm") состоит из следующих модулей
	программный модуль отображения данных "WEB" (далее ПМ "Web"), программный модуль выгрузки данных "Synchro",
	программный модуль анализа данных, локальное хранилище необработанных данных, хранилище обработанных данных.
	
	\subsection{Программный модуль отображения данных "WEB-ALARM"}
	Программный модуль отображения данных представляет из себя приложение написанное
	на языке программирования Ruby с использование фреймворка Rails. Для своей работы требует сервер под управлением ОС Linux и наличие хранилища данных, реализованного в виде СУБД MySQL. Программный модуль осуществляет выборку и отображение сообщений полученных от абонентских терминалов, далее АТ, а также показывает координатную и датчиковую информацию содержащуюся в этом сообщение. В случае наличия датчиковой информации, которая трактуется нами как информация повышенного внимания, она маркируется красным цветом.
	
	\subsection{Программный модуль обработки данных "ALARM"}
	Программный модуль обработки данных представляет из себя приложение написанное на
	языке с++ с использование фреймворка QT. Программный модуль анализирует файловые сообщения, доступ к которомы получает посредством сетевой файловой системы из файлового хранилища данных. На основании анализа файловых сообщений ПМ производит заполнение БД, куда записываеются раскодированные и переформатированный данные полученные из файловых сообщений, после чего сообщение удаляется из хранилища. 
	\subsubsection{Настройка ПМ "ALARM"}
	\subsubsection{Настройка на OC Ubuntu 16}
	Для настройки ПМ "ALARM" необходимо перенести файлы
	\begin{enumerate}
	\item alarm
	\item alarm.sh
	\item alarm.ini
	\end{enumerate}
	
	в папку пользователя пусть будет /home/user/ALARM/
	Далее добавить в cron файл запись 

	\fcolorbox{green}{lgreen}{*/1 * * * * <Имя пользователя>  <Путь к папке программы>/alarm.sh}
	cron обеспечит автоматический запуск приложения в случае программного сбоя или сбоя по питанию
	\subsubsection{Настройка БД}
	БД представлена тремя таблицами
	\begin{enumerate}
	\item Coords
	\item Files
	\item Messages
    \end{enumerate} 
	таблица
	\begin{verbatim}
    

+------------+--------------+------+-----+---------+----------------+
| Поле       | Тип          | Null | Key | Default | Extra          |
+------------+--------------+------+-----+---------+----------------+
| id         | int(11)      | NO   | PRI | NULL    | auto_increment |
| received   | datetime     | NO   |     | NULL    |                |
| lat        | float        | YES  |     | NULL    |                |
| lon        | float        | YES  |     | NULL    |                |
| lat_b      | tinyblob     | YES  |     | NULL    |                |
| lon_b      | tinyblob     | YES  |     | NULL    |                |
| sensor     | tinyblob     | YES  |     | NULL    |                |
| message_id | int(11)      | NO   | MUL | NULL    |                |
| D1         | int(11)      | NO   |     | NULL    |                |
| D2         | int(11)      | NO   |     | NULL    |                |
| D3         | int(11)      | NO   |     | NULL    |                |
| AL         | int(11)      | NO   |     | NULL    |                |
| IG         | int(11)      | NO   |     | NULL    |                |
| lat_s      | varchar(255) | YES  |     | NULL    |                |
| lon_s      | varchar(255) | YES  |     | NULL    |                |
+------------+--------------+------+-----+---------+----------------+
\end{verbatim}
\begin{verbatim}
+-----------+--------------+------+-----+---------+----------------+
| Field     | Type         | Null | Key | Default | Extra          |
+-----------+--------------+------+-----+---------+----------------+
| id        | int(11)      | NO   | PRI | NULL    | auto_increment |
| name      | varchar(255) | NO   | MUL | NULL    |                |
| processed | int(11)      | NO   |     | NULL    |                |
+-----------+--------------+------+-----+---------+----------------+
\end{verbatim}

\begin{verbatim}
+-----------+--------------+------+-----+---------+----------------+
| Field     | Type         | Null | Key | Default | Extra          |
+-----------+--------------+------+-----+---------+----------------+
| id        | int(11)      | NO   | PRI | NULL    | auto_increment |
| name      | varchar(255) | NO   | MUL | NULL    |                |
| processed | int(11)      | NO   |     | NULL    |                |
+-----------+--------------+------+-----+---------+----------------+

\end{verbatim}
	\subsubsection{Настройка доступа к файловому хранилищу}
	В случае настройки Linux необходимо примонтировать папку с сообщениями, котора затем настраивается в файле alarm.ini
	Для этого производим редактирования файла /etc/fstab добавляя автоматически монтируемую дирректорию
	//192.68.20.199/allaccess /home/server cifs username=guest, pass=guess
	\subsection{Программный модуль выгрузки данных "ALARM-SYNCHRO"}
	Программный модуль выгрузки данных представляет из себя приложение написанное на языке perl. Приложение осуществляет выгрузку файловых сообщений из внешнего хранилища в локальное хранилище для дальнейшей обработки программным модулем обработки данных, кроме этого ПМ осуществляет резервирование выгруженных из хранилища данных.
	Располагается модуль на сервере по адресу
	/home/user/alarm.pl
	Файл настроек располагается в этой же папке 
	/home/user/alarm.ini
	запускается автоматически при перезапуске системы при помощи демона cron или в ручном режиме
	/home/user/alarm.pl -f /home/user/alarm.ini
    \fcolorbox{green}{lgreen}{/home/user/alarm.pl -f /home/user/alarm.ini}
    файл конфигурации alarm.ini
    ftp-login - логин для доступа к внешнему хранилищу
    ftp-password - пароль для доступа к внешнему хранилищу
	\subsection{Локальное хранилище необработанных данных "ALARM-STORAGE"}
	\section{Проверка работоспособности серверного ПО}
	Локальное хранилище необработанных данных представляет из себя сервер под управление ОС Ubuntu на котором установлео приложение Samba, позволяющее  получить доступ через протокол SMB/CIFS. Представлено двумя сетевыми папками
	\\<ip адрес сервера>\\allaccess\\storage
	в первую попадают сообщения из внешнего FTP хранилища и впоследствии удаляются после обработки
	\\<ip адрес сервера>\\allaccess\\exchange
	в эту папку попадают сообщения из внешнего FTP хранилища и здесь же и остаются
	с целью хранения
	\section{Настройка хранилища}
	Для автоматического подключения SAMBA необходимо прописать в файл
	/etc/fstab
	\begin{verbatim}
	//192.168.20.199/allaccess/     /home/server/   cifs username=guest,pass=guest  0       0
	\end{verbatim}
	где 192.168.20.199 - адресс локального хранилища
	/home/server - локальная папка куда монтируется папка /allaccess/ локального хранилища
	\subsection{Проверка работоспособности подсистемы отображения данных}
	Открыть в окне браузера http://<ip адресс>:3000/messages
	Если не открывается то проверить доступность сервера при
	помощи встроенной в операционную систему утилиты ping.
	
	\fcolorbox{green}{lgreen}{ping <ip адресс>}
    \subsection{Проверка работоспособности подсистемы обработки данных}
    В командной строке набрать 
    	\fcolorbox{green}{lgreen}{ps -ax | grep alarm}
    Убедиться в наличии работающего процесса alarm.
    \subsection{Проверка работоспособности подсистемы выгрузки данных}

\end{document}